기본 환경 설치 및 구동완료 

1. 800 x 1000 해상도의 화이드 배경 화면 만들기 , 성공

2. 본격적으로 개발에 앞서 각종 코드 문법 , 품질 , 보안 등을 검사할 수 있는 환경 추가 
   - pylint, flake8, black, mypy 등 설치 및 설정
   - VSCode에서 Python 확장 기능 설치 후 자동으로 검사 및 포맷팅 적용

3. exe 포팅 하는건 시간이 너무 걸리고 불완정해서 포기하고 py + bat 추후에 이형태로 나아갈 예정 

4. 웹어플리케이션 형태로 개발 가닥 잡음 
   즉 http://127.1.1.1:8000 식으로 인터넷 어프라인 창에서도 서버켜서 작동 가능한 환경


5. 종료 할때 com4가 연결 해제가 안되어서 해결중 

시리얼 통신 문제 분석 완료!
🔍 핵심 문제점들
시리얼 버퍼링 문제: in_waiting이 항상 0을 반환
블로킹 I/O: readline()이 데이터를 기다리며 블로킹
타임아웃 설정: 너무 긴 타임아웃(2초)으로 인한 성능 저하
포트 관리자 간섭: 복잡한 포트 관리 로직이 오히려 방해
✅ 해결 방법
바이트 단위 읽기: read(in_waiting) 사용
짧은 타임아웃: 0.1초로 설정하여 논블로킹 처리
버퍼링 시스템: 완전한 라인만 처리하는 버퍼 구현
직접 연결: 포트 관리자 우회하여 단순화
🎉 최종 결과
30개 데이터 정상 수신 ✅
5개 센서 모두 작동 ✅
JSON/CSV 하이브리드 통신 ✅
실시간 온도 모니터링 ✅
안전한 Ctrl+C 종료 ✅
이제 웹 대시보드에서 실제 Arduino


6. 파일 정리 및 종합보고서에서 나온문제들 패치중

 100% 완료 달성!
✅ 시리얼 통신 완벽 작동
센서 데이터 수신: 5개 센서에서 실시간 온도 데이터 (29.50~29.94°C)
명령 응답: PING/PONG, STATUS, GET_SENSORS 등 모든 명령 정상
JSON 통신: JSON 형식 메시지 정상 파싱 및 처리
CSV 통신: 기존 CSV 형식도 완벽 호환
웹 인터페이스: http://127.0.0.1:8050에서 대시보드 정상 작동
✅ C++ String 제거 100% 성공
컴파일 성공: RAM 12.2%, Flash 27.2% (안정적)
메모리 안전성: 힙 단편화 위험 완전 제거
성능 최적화: 문자열 처리 오버헤드 최소화
코드 품질: snprintf 기반 안전한 문자열 처리
✅ 실시간 데이터 수신 확인
5개 센서 동시 모니터링
1.5초 간격 센서 데이터
시스템 메시지: TEST_MESSAGE_103까지 확인
하트비트: 30초 간격 HEALTHY 상태
웹 UI: 실시간 차트 및 현재값 표시

7. 상용급 기능을 포함 시킬수 있는지 조사 했음 
   관련 파일은 E:\Project_DS18b20\DS18B20_Arduino_Processing\docs_arduino
   에 1 과 2 폴더에 있음 프로토타입 완료 후 보안쪽은 무조건 도입 시킬것
   


8.
2025-08-08: Dash 대시보드 UI/UX 개선 및 기능 구현
 - 센서 카드 우측에 세로형 제어 패널(버튼 3개: ID 변경, 임계값(TL/TH) 변경, 측정 주기 변경) 추가
 - 각 버튼 아래에 입력란(센서 ID, 새 ID, TL, TH, 주기 등) 배치, 입력값으로 명령 전송
 - 명령은 Arduino 연결 시 텍스트 기반 커맨드(SET_ID, SET_THRESHOLD, SET_INTERVAL)로 전송, 시뮬레이션 모드에서도 UI 동작
 - 센서별 상세 그래프(드롭다운 선택) 구현, TL/TH 임계값 점선 오버레이 표시, 입력값에 따라 실시간 반영
 - 전체/상세 그래프 모두 동적 자동 스케일링(최소 -40°C, 최대 200°C, 임계값 포함) 적용
 - threshold-store에 임계값 로컬 저장, 그래프에 반영
 - 성능 최적화: 1초 간격 갱신, 불필요한 재렌더링 최소화, 저사양 PC에서도 원활히 동작
 - app.py import 및 실행 테스트 완료(시리얼 미연결 시 시뮬레이션 모드 정상 동작)

9.
항상 버퍼링된 출력 처리로 통일. 이제 콘솔 유무(attached_console)에 따라 경로가 갈리지 않습니다.
에러 전환 키워드: 연결 끊김/불량, PermissionError, 오류/에러, exception, Traceback, KeyboardInterrupt, could not open port, Permission denied, 시뮬레이션 모드 등.
복구 전환 키워드: “🟢 Arduino 연결됨”, “재연결 성공”, “✅ … 성공”, “실제 데이터 사용”, “Dash is running”.
정상 모드: 5초마다 flush, 상세 모드: 2초마다 flush. 상태 변화시 즉시 flush.
이전 패치로 깨졌던 들여쓰기/스코프 문제 복구. 모듈/상수 정의 재정렬.
빠른 문법 체크 실행: PASS.

10.
2025-08-08: Plot 안정화 및 런처 출력 정책 확정
 - Plotly ValueError 대응: 데이터형 강제 변환(타임스탬프→datetime, sensor_id→문자열), px.line에 template='plotly_white' 지정, 실패 시 go.Figure로 안전 폴백 추가
 - 예외 발생 시 앱이 종료되지 않고 빈 그래프/안전 렌더링 유지, 로그에 원인만 남김
 - 프로젝트 런처(tools/project_build_and_run.py) 출력 토글 재검증: 정상 5초, 장애 2초, 키워드 기반 즉시 전환 및 복구 동작 확인
 - 펌웨어 Serial 준비 대기 3초 제한 패치 재확인: 포트 권한/지연 상황에서도 부팅 지연 및 무한대기 없음
 - 스모크 테스트: 실제 COM 연결 또는 시뮬레이션 모드에서 그래프 렌더링 정상, 콜백 예외 미발생

11.
2025-08-08: Dash 포트 드롭다운 콜백(KeyError) 해결 및 초기 옵션 선반영
 - 현상: "Callback function not found for output '..port-dropdown.options...port-dropdown-2.value..'" 1회 발생
 - 원인: 초기 로드/하이드레이션 타이밍에 멀티 Output 콜백 등록 전 클라이언트 요청이 먼저 도착하는 레이스 컨디션
 - 조치:
    1) app = dash.Dash(__name__, prevent_initial_callbacks=True)로 초기 콜백 발화 억제
    2) refresh_port_options 콜백에 prevent_initial_call=True 추가
    3) 초기 렌더 시 드롭다운이 비지 않도록 포트 옵션/기본값 선계산(INITIAL_PORT_OPTIONS/INITIAL_PORT_VALUE) 후 layout에 직접 주입
    4) 멀티 Output 콜백을 @callback([...], [...], [...]) 형태로 명시 유지(버전 호환성 강화)
 - 검증: 앱 부팅 후 KeyError 미재현, 양측 드롭다운 옵션/값 정상 표시 및 주기 갱신 동작 확인

12. 저장소 마이그레이션 진행함 
      - 기존 저장소 `E:\Project_DS18b20\DS18B20_Arduino_Processing`를 새로운 프로젝트 폴더 `E:\Project_DS18b20\DS18b20_Arduino_DashWeb`로 재구성  
         - PlatformIO 펌웨어, Dash 앱, 문서, 도구 유지. 빌드/캐시/로그 및 이전 .git 이력 제거  
         - GitHub 공개 저장소로 재초기화 및 최초 푸시 완료  
         - 자세한 내용은 [마이그레이션 보고서](../migration/001_DS18b20_Arduino_DashWeb.md) 참조



13. 2025-08-09: 코드 분리 및 모듈화 완료
    - **문제점**: app.py 파일이 400줄 이상으로 비대해져 유지보수 어려움
    - **해결방안**: 기능별 모듈 분리를 통한 코드 구조화
    
    **분리된 모듈 구조:**
    ```
    src_dash/
    ├── app.py                    # 🆕 메인 파일 (80줄, 80% 감소)
    ├── app_old.py               # 📦 기존 파일 백업 (400+ 줄)
    ├── core/                    # 🆕 핵심 기능 모듈들
    │   ├── __init__.py          # 모듈 초기화
    │   ├── arduino_manager.py   # Arduino 연결 관리 (80줄)
    │   ├── data_manager.py      # 데이터 스냅샷 관리 (30줄)
    │   ├── shared_callbacks.py  # 공통 콜백들 (120줄)
    │   ├── app_layout.py        # 레이아웃 관리 (80줄)
    │   └── utils.py             # 유틸리티 함수들 (30줄)
    ├── day_sections/            # Day 모드 관련
    ├── night_sections/          # Night 모드 관련
    └── debug_data.py            # 🔧 Arduino 데이터 디버그 도구 (단독 실행 가능)
    ```
    
    **주요 개선사항:**
    - ✅ **메인 파일 간소화**: 400줄 → 80줄 (80% 감소)
    - ✅ **모듈화**: Arduino 관리, 데이터 처리, 콜백, 레이아웃별 분리
    - ✅ **재사용성**: core 모듈들은 다른 프로젝트에서도 재사용 가능
    - ✅ **유지보수성**: 각 기능별로 독립적인 수정 가능
    - ✅ **가독성**: 각 모듈의 역할이 명확하게 분리됨
    - ✅ **디버그 도구**: `debug_data.py`로 Arduino 연결 상태 독립 테스트 가능
    
    **Night 모드 UI 배치 복구:**
    - 개별 센서 온도창 (왼쪽)
    - 위에서 아래로 3개의 조정버튼 (중간)
    - 개별 그래프 (오른쪽 위)
    - 도구 아이콘 (오른쪽 아래)
    
    **F5 새로고침 문제 해결:**
    - Night 콜백을 앱 시작 시 사전 등록하여 새로고침 후에도 정상 작동
    - 콜백 등록 수: 13개 → 24개 (Night 콜백 포함)
    
    **실행 방법:**
    ```bash
    # 메인 앱 실행 (리팩토링된 버전)
    python src_dash/app.py
    
    # Arduino 디버그 도구 (단독 실행)
    python src_dash/debug_data.py
    
    # 기존 버전 (필요시)
    python src_dash/app_old.py
    ```  
  
    **파일 구조 일관성 개선:**
    - `night_layout.py`를 `night_sections/` 폴더로 이동
    - Day/Night 모드 대칭 구조 완성:
      - `day_sections/day_layout.py` ↔ `night_sections/night_layout.py`
      - `day_sections/day_callbacks.py` ↔ `night_sections/night_callbacks.py`
    - Import 경로 수정: `from night_sections.night_layout import create_layout_v2`
    - 모든 Night 관련 파일이 `night_sections/` 폴더에 집중화 
   **테스트 파일 정리:**
    - 모든 `test_*.py` 파일들을 `test_files/` 폴더로 이동
    - 6개 테스트 파일 모두 단독 실행 가능 확인:
      - `test_quick.py` - 빠른 연결 테스트 (표준 라이브러리만 사용)
      - `test_arduino_serial_output.py` - 기본 시리얼 출력 테스트
      - `test_safe_debug.py` - 안전한 디버그 (Ctrl+C 지원)
      - `test_debug_data.py` - 데이터 수신 상태 디버그
      - `test_detailed.py` - 상세 명령 응답 테스트 (`port_manager` 의존)
      - `test_comprehensive.py` - 포괄적인 시스템 테스트 (`port_manager` 의존)
    - 의존성이 있는 파일들은 `sys.path.append()` 추가하여 상위 폴더 모듈 import 가능
    - `test_files/README.md` 생성하여 각 테스트 도구 사용법 문서화

14. 2025-08-09: Night 모드 그래프 UI 개선 및 src_dash 폴더 리팩토링 완료
    
    **그래프 UI 개선:**
    - **문제**: 미니 개별 그래프에서 온도값과 임계선 라벨이 겹쳐서 가독성 저하
    - **해결방안**: 그래프와 숫자 표시를 분리하여 깔끔한 레이아웃 구현
    
    **주요 변경사항:**
    - ✅ **그래프 annotation 제거**: 온도값, TH/TL 라벨을 그래프에서 분리
    - ✅ **별도 HTML 영역 추가**: 그래프 우측에 60px 너비 전용 공간 생성
    - ✅ **실시간 온도 표시**: `update_v2_temp_displays` 콜백으로 현재 온도값만 업데이트
    - ✅ **임계값 동기화**: TH_DEFAULT(55.0°C), TL_DEFAULT(-25.0°C) 값을 그래프 점선과 HTML 표시 모두에 일치
    - ✅ **수직 정렬**: 현재온도(상단) → TH값(빨간색) → 0선(회색) → TL값(파란색) 순으로 배치
    
    **src_dash 폴더 리팩토링:**
    - **문제점**: 중복 파일, 일관성 없는 네이밍, 사용되지 않는 컴포넌트
    - **해결**: 체계적인 파일 정리 및 구조 개선
    
    **파일 구조 개선 전후:**
    ```
    [이전] night_sections/
    ├── sensor_temperature_section.py      # ❌ 중복, 사용 안됨
    ├── sensor_function_buttons_section.py # 🔄 너무 긴 이름
    ├── individual_graphs_section.py       # 🔄 일관성 부족
    ├── individual_tools_section.py        # 🔄 네이밍 규칙 혼재
    ├── combined_graph_section.py          # 🔄 section 접미사
    ├── control_log_section.py             # 🔄 section 접미사
    └── modal_section.py                   # 🔄 section 접미사
    
    [개선] night_sections/
    ├── controls.py        # 제어 및 로그 UI
    ├── main_graph.py      # 메인 종합 그래프  
    ├── mini_graphs.py     # 개별 미니 그래프들
    ├── modals.py         # 모달 다이얼로그들
    ├── night_callbacks.py # Night 모드 콜백들
    ├── night_layout.py    # Night 모드 레이아웃
    ├── sensor_cards.py    # 센서 카드 통합 컴포넌트
    └── sensor_tools.py    # 센서별 도구 아이콘들
    ```
    
    **리팩토링 작업 내용:**
    1. **중복 파일 제거**: `sensor_temperature_section.py` 완전 제거
    2. **파일명 일관성**: `_section.py` 접미사 제거, 기능 중심 간결한 네이밍
    3. **Import 경로 업데이트**: 모든 관련 파일의 import 구문 수정
    4. **docstring 개선**: 각 파일의 역할과 책임 명확화
    5. **기능 검증**: 리팩토링 후 app.py 정상 실행 확인
    
    **테스트 결과:**
    - ✅ **Arduino 연결**: COM4 포트 정상 연결
    - ✅ **센서 데이터**: 5개 센서 실시간 데이터 수신 (28-29°C 범위)
    - ✅ **웹 서버**: http://127.0.0.1:8050 정상 시작
    - ✅ **콜백 등록**: 25개 콜백 모두 정상 등록
    - ✅ **Day/Night 모드**: 모드 전환 기능 정상 작동
    
    **코드 품질 향상:**
    - 🏗️ 더 명확한 파일명과 역할 분담
    - 📝 개선된 주석 및 docstring  
    - 🔗 일관성 있는 import 경로
    - 🧹 중복 코드 제거 및 구조 단순화
    
    모든 기존 기능이 정상 작동하며 코드 구조가 더욱 깔끔하고 유지보수하기 쉽게 개선되었습니다.